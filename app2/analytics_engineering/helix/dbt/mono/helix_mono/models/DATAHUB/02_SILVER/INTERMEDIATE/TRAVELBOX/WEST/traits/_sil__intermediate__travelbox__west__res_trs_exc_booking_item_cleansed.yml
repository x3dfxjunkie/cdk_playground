version: 2

models:
  - name: sil__intermediate__travelbox__west__res_trs_exc_booking_item_cleansed
    description: '{{ doc("sil__intermediate__travelbox__west__res_trs_exc_booking_item_cleansed") }}'

    meta:
      environment_wh:
        - env: LOCAL
          wh: HOTEL_LODGING_LATEST_WH_S
        - env: LATEST
          wh: HOTEL_LODGING_LATEST_WH_S
        - env: EPHEMERAL_PR
          wh: PR_SMALL_WH
        - env: STAGE
          wh: HOTEL_LODGING_STAGE_WH_M
        - env: PROD
          wh: HOTEL_LODGING_PROD_WH_M

    config:
      tags:
        - layer=silver_intermediate
        - sub_layer=silver_intermediate_cleansed
        - active=LATEST
        - active=STAGE
        - active=LOAD
        - active=PROD

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - data_booking_id
            - data_item_no
            - data_product_code
            - metadata_checksum

    columns:
      - name: data_booking_id
        description: "The system generated id of the booking | example: 13913582"
        tags: ['column_designation=primary_key']
        tests:
          - not_null

      - name: data_product_code
        description: "Deprecated | example: TRS"
        tags: ['column_designation=primary_key']
        tests:
          - not_null

      - name: data_item_no
        description: "Deprecated | example: 1"
        tags: ['column_designation=primary_key']
        tests:
          - not_null

      - name: data_type
        description: "The availbility type (1 = Available 2 = Free Sell) | example: T"
        meta:
          checksum: True

      - name: data_transfer_no
        description: "NaN | example: 1"
        meta:
          checksum: True

      - name: data_pickup_point
        description: "Pick up point of the transfer or excursion | example: Santa Ana John Wayne Apt , Santa Ana , United States of America"
        meta:
          checksum: True

      - name: data_dropoff_point
        description: "Drop off point of the transfer or excursion | example: DLR Resort , Anaheim , United States of America"
        meta:
          checksum: True

      - name: data_description
        description: "The TravelBox name of the board basis | example: QoXkdqQppDMTgzQAfeZy"
        meta:
          checksum: True

      - name: data_transfer_mode_code
        description: "Transfer mode code, Car- CAR, Seat in Coach - SIC, Lux Bus - LUB, Limo - Limo | example: KS"
        meta:
          checksum: True

      - name: data_transfer_mode
        description: "Deprecated | example: Karmel Shared Shuttle"
        meta:
          checksum: True

      - name: data_pickup_point_code
        description: "Deprecated | example: SNA"
        meta:
          checksum: True

      - name: data_pickup_point_type
        description: "Deprecated | example: A"
        meta:
          checksum: True

      - name: data_dropoff_point_code
        description: "Corresponding code in the city table to the drop off city | example: DISNEY"
        meta:
          checksum: True

      - name: data_dropoff_point_type
        description: "Deprecated | example: R"
        meta:
          checksum: True

      - name: data_exc_location_id
        description: "Deprecated | example: 3719"
        meta:
          checksum: True

      - name: data_exc_location
        description: "Excursion location description | example: wwqpENQGrgIBcXXTQmXw"
        meta:
          checksum: True

      - name: data_transfer_mode_no
        description: "NaN | example: 1"
        meta:
          checksum: True

      - name: data_minimum_vehicles
        description: "The minimum number of vehicles associated with the transfer/excursion booking item | example: 1"
        meta:
          checksum: True

      - name: data_return_compulsory
        description: "Oracle managed system tables used for materialised views | example: 0"
        meta:
          checksum: True

      - name: data_transfer_name
        description: "Name of the transfer | example: 2022 Karmel Shared SNA/ANA 5 Max CC"
        meta:
          checksum: True

      - name: data_h2_h_product_id
        description: "NaN | example: 0"
        meta:
          checksum: True

      - name: data_h2_h_booking_type_id
        description: "NaN | example: 0"
        meta:
          checksum: True

      - name: data_outbound_flight_no
        description: "NaN | example: wGNoucWdHNUhKwIYgvea"
        meta:
          checksum: True

      - name: data_outbound_dep_apt
        description: "NaN | example: XgyuomPwVrXIHtmYvvzN"
        meta:
          checksum: True

      - name: data_outbound_arr_time
        description: "NaN | example: 2003-09-12 11:45:26"
        meta:
          checksum: True

      - name: data_outbound_airline
        description: "IATA code of destination airport | example: BKkiGilodagOBlvbAdsz"
        meta:
          checksum: True

      - name: data_inbound_flight_no
        description: "NaN | example: HiGzuttTWQbFUXNNIHpD"
        meta:
          checksum: True

      - name: data_inbound_arr_apt
        description: "NaN | example: SYSOBTzptxRTmzMIPTmw"
        meta:
          checksum: True

      - name: data_inbound_dep_time
        description: "NaN | example: 2007-01-05 01:45:09"
        meta:
          checksum: True

      - name: data_inbound_airline
        description: "IATA code of inbound airline | example: jtIeceWRXRdwFMOYarQZ"
        meta:
          checksum: True

      - name: data_outbound_ship_name
        description: "NaN | example: bsYjHEdrFZSBpRsCWJLy"
        meta:
          checksum: True

      - name: data_outbound_dep_port
        description: "NaN | example: GbThvfQTgiAFDQfLBuuY"
        meta:
          checksum: True

      - name: data_inbound_arr_port
        description: "NaN | example: NOIagKJrHyRUgyDKNjox"
        meta:
          checksum: True

      - name: data_inbound_ship_name
        description: "NaN | example: HRYRAMlOSoCVuAgDZNfi"
        meta:
          checksum: True

      - name: data_cru_foreign_bkng_id
        description: "NaN | example: VSBvCjpALpslkjjJOrpx"
        meta:
          checksum: True

      - name: data_start_end_times_edited
        description: "In reservation transfer summary or reservation transfer loading start and end times edited or not are specified or not, 1 - edited , 0 not not | example: 0"
        meta:
          checksum: True

      - name: data_last_modified_time
        description: "The time at which the last modification has done. | example: 1989-08-26 02:24:26"
        meta:
          checksum: True

      - name: data_fulfillment_freq
        description: "Specify the frequency type of gategory, P: per Person, I: Per Item | example: I"
        meta:
          checksum: True

      - name: min_metadata_timestamp
        description: "The Minimum Metadata Timestamp field is used for updating the version end date of the active record in the target table"
        tests:
          - not_null

      - name: metadata_checksum
        description: "Metadata Checksum"
        tests:
          - not_null

      - name: metadata_timestamp
        description: "Timestamp of when the record was sent to the stream | example: 2023-08-11 14:38:01.378618"
        tests:
          - not_null

      - name: metadata_record_type
        description: "Type of record | example: data"

      - name: metadata_operation
        description: "Type of operation [insert, delete, update] | example: update"

      - name: metadata_partition_key_type
        description: "Partition key | example: schema-table"

      - name: metadata_schema_name
        description: "Name of schema | example: SFLNSMD"

      - name: metadata_table_name
        description: "Name of table | example: AP_LVL_N_ENTTL_FISCAL_DT"

      - name: metadata_transaction_id
        description: "Unique Transaction Identifier | example: 59558768559209"

      - name: metadata_transaction_record_id
        description: "Transaction Record ID | example: 70974432245344"

      - name: metadata_prev_transaction_id
        description: "Previous Transaction ID | example: 70974432245344"

      - name: metadata_prev_transaction_record_id
        description: "Previous Transaction Record ID | example: 70974432245344"

      - name: metadata_commit_timestamp
        description: "Commit Timestamp | example: 2023-03-29T15:30:19.109655Z"

      - name: metadata_stream_position
        description: "Stream Position | example:"

      - name: metadata_insert_datetime
        description: "This is the current timestamp in UTC when the record is inserted"
        tests:
          - not_null

      - name: metadata_batch_user
        description: "Batch user. Default value will be dbt"
        tests:
          - not_null

      - name: landing_id
        description: ""

      - name: landing_file_name
        description: ""

      - name: landing_file_row_number
        description: ""

      - name: landing_file_last_modified
        description: ""

      - name: landing_timestamp
        description: ""

      - name: landing_cloudevent_id
        description: ""

      - name: landing_cloudevent_specversion
        description: ""

      - name: landing_cloudevent_time
        description: ""

      - name: landing_cloudevent_source
        description: ""

      - name: landing_cloudevent_subject
        description: ""

      - name: landing_cloudevent_stream
        description: ""

      - name: landing_cloudevent_type
        description: ""

      - name: landing_cloudevent_dataschema
        description: ""

      - name: landing_cloudevent_traceparent
        description: ""

      - name: landing_cloudevent_tracestate
        description: ""

      - name: landing_cloudevent_check_sum
        description: ""

      - name: landing_cloudevent_router_database
        description: ""

      - name: landing_cloudevent_router_schema
        description: ""

      - name: landing_cloudevent_router_table
        description: ""

      - name: landing_cloudevent_validated
        description: ""

      - name: landing_cloudevent_data_contract_version
        description: ""

      - name: landing_cloudevent_datacontenttype
        description: ""

      - name: landing_cloudevent_exception_error
        description: ""