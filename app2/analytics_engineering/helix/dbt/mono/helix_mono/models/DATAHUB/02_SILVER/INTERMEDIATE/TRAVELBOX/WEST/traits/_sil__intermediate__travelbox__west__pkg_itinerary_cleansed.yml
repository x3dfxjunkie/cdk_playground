version: 2

models:
  - name: sil__intermediate__travelbox__west__pkg_itinerary_cleansed
    description: '{{ doc("sil__intermediate__travelbox__west__pkg_itinerary_cleansed") }}'

    meta:
      environment_wh:
        - env: LOCAL
          wh: HOTEL_LODGING_LATEST_WH_S
        - env: LATEST
          wh: HOTEL_LODGING_LATEST_WH_S
        - env: EPHEMERAL_PR
          wh: PR_SMALL_WH
        - env: STAGE
          wh: HOTEL_LODGING_STAGE_WH_M
        - env: PROD
          wh: HOTEL_LODGING_PROD_WH_M

    config:
      tags:
        - layer=silver_intermediate
        - sub_layer=silver_intermediate_cleansed
        - active=LATEST
        - active=STAGE
        - active=LOAD
        - active=PROD

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - data_itinerary_no
            - data_package_id
            - metadata_checksum

    columns:
      - name: data_last_modified_time
        description: "The time at which the last modification has done. | example: 1975-07-18 18:16:10"
        meta:
          checksum: True

      - name: data_hotel_element_no
        description: "NaN | example: 3"
        meta:
          checksum: True

      - name: data_max_bkg_to_dep_days
        description: "NaN | example: 4648"
        meta:
          checksum: True

      - name: data_dest_city_code
        description: "Deprecated | example: hIffeVqiaEhWWRgBRuQQ"
        meta:
          checksum: True

      - name: data_commission_override
        description: "Specifies whether the commission rate is overriden for supplement | example: 0"
        meta:
          checksum: True

      - name: data_threshold
        description: "Deprecated | example: EXACT"
        meta:
          checksum: True

      - name: data_commission
        description: "The commission percentage recieved by the tour operator | example: 0.0"
        meta:
          checksum: True

      - name: data_calc_pax_base
        description: "Setup at Departure tab of Dates node of the package. Used to determine_x000D_
the group size of the contract for which are defined as group rate contracts. | example: 0"
        meta:
          checksum: True

      - name: data_dep_date_exist
        description: "deprecated | example: 0"
        meta:
          checksum: True

      - name: data_push_sales_exist
        description: "A flag indicating whether Push Sales Exist or not._x000D_
1 - Exist_x000D_
0 - Not Exist. | example: 0"
        meta:
          checksum: True

      - name: data_special_offer_exist
        description: "A flag indicating whether Special Offers Exist or not._x000D_
1 - Exist_x000D_
0 - Not Exist. | example: 0"
        meta:
          checksum: True

      - name: data_blackout_exist
        description: "A flag indicating a blackout exists | example: 0"
        meta:
          checksum: True

      - name: data_ebr_discount_exist
        description: "Deprecated | example: 0"
        meta:
          checksum: True

      - name: data_visa_exist
        description: "A flag indicating whether Visa Exist or not._x000D_
1 - Exist_x000D_
0 - Not Exist. | example: 0"
        meta:
          checksum: True

      - name: data_cms_code
        description: "User defined CMS code which is taken as parameter values for tb_code, tb_itin, tb_pricegrid in package, itinerary and price grid respectively in the CMS URL which refers from travelbox to CMS. If this value is not defined the system will take package code, itinerary code and price grid name as default value of above variables. | example: AELNPsvHXZtheVWJYzZo"
        meta:
          checksum: True

      - name: data_iti_dest_city
        description: "TravelBox City Code of the Itinerary destination city | example: ANA"
        meta:
          checksum: True

      - name: data_country
        description: "The TravelBox code of the country for which the rule is defined | example: US"
        meta:
          checksum: True

      - name: data_tour_region
        description: "The TravelBox Tourist Region code for the Package. Tourist Region for the package is decided by an internal logic. | example: fqJjyllkFVcHMKitBiCF"
        meta:
          checksum: True

      - name: data_supplier_id
        description: "Not in DSN Scope | example: 29923"
        meta:
          checksum: True

      - name: data_centers
        description: "Deprecated | example: 1727"
        meta:
          checksum: True

      - name: data_resort
        description: "The foreign Key which refers the field CODE of the ACT_ABSORPTION table | example: DISNEY"
        meta:
          checksum: True

      - name: data_min_bkg_to_dep_days
        description: "Required minimum number of days between the booking date and departure date | example: 1"
        meta:
          checksum: True

      - name: data_package_id
        description: "The foreign key which refers the field PACKAGE_ID of the table PKG_HOLIDAY | example: 13713"
        tags: ['column_designation=primary_key']
        tests:
          - not_null

      - name: data_itinerary_no
        description: "The foreign key which refers the field ITINERARY_NO of the table PKG_ITINERARY | example: 51"
        tags: ['column_designation=primary_key']
        tests:
          - not_null

      - name: data_code
        description: "The TravelBox code of the board basis | example: 51 ITN [17N]"
        meta:
          checksum: True

      - name: data_name
        description: "The name of the contract type | example: Itinerary [17 nights] FALCH"
        meta:
          checksum: True

      - name: data_nights
        description: "This is 1 since the rates are for a day. | example: 17"
        meta:
          checksum: True

      - name: data_status
        description: "The TravelBox code of the status of the contract | example: 503"
        meta:
          checksum: True

      - name: data_stage
        description: "The TravelBox code of the stage of the contract | example: 50301"
        meta:
          checksum: True

      - name: data_average_margin
        description: "Deprecated | example: 0.0"
        meta:
          checksum: True

      - name: data_stage_reason
        description: "The TravelBox name of the reason for the stage of the contract | example: BanFJgrUkynhmypmyiIz"
        meta:
          checksum: True

      - name: data_extra_stays_only
        description: "A flag indicating whether Flex Parameters are enabled or not allowing user to define the applicable itineraries._x000D_
1 - Flex Parameters are enabled_x000D_
0 - Flex Parameters are not enabled | example: 0"
        meta:
          checksum: True

      - name: data_package_stage
        description: "A flag indicating whether Stage and Status of the package are applied automatically or not. | example: 1"
        meta:
          checksum: True

      - name: data_min_pax
        description: "If this is a group based contract, the minimum number of pax for which the rates are applied | example: 0"
        meta:
          checksum: True

      - name: data_max_pax
        description: "If this is a group based contract, the maximum number of pax for which the rates are applied | example: 0"
        meta:
          checksum: True

      - name: data_variation_code
        description: "Deprecated | example: oplMnMRezajoYgtxhzUG"
        meta:
          checksum: True

      - name: data_variation_no
        description: "The system generated number of the variation | example: 3773"
        meta:
          checksum: True

      - name: data_set_no
        description: "The numeric index within the scheme | example: 1"
        meta:
          checksum: True

      - name: data_hotel_code
        description: "When an Itinerary contains an Accommadation Item, the suppliear code of the item is saved in this field. The value is saved in the Itinerary level, so it provides faster access.  | example: FALCH"
        meta:
          checksum: True

      - name: min_metadata_timestamp
        description: "The Minimum Metadata Timestamp field is used for updating the version end date of the active record in the target table"
        tests:
          - not_null

      - name: metadata_checksum
        description: "Metadata Checksum"
        tests:
          - not_null

      - name: metadata_timestamp
        description: "Timestamp of when the record was sent to the stream | example: 2023-08-11 14:38:01.378618"
        tests:
          - not_null

      - name: metadata_record_type
        description: "Type of record | example: data"

      - name: metadata_operation
        description: "Type of operation [insert, delete, update] | example: update"

      - name: metadata_partition_key_type
        description: "Partition key | example: schema-table"

      - name: metadata_schema_name
        description: "Name of schema | example: SFLNSMD"

      - name: metadata_table_name
        description: "Name of table | example: AP_LVL_N_ENTTL_FISCAL_DT"

      - name: metadata_transaction_id
        description: "Unique Transaction Identifier | example: 59558768559209"

      - name: metadata_transaction_record_id
        description: "Transaction Record ID | example: 70974432245344"

      - name: metadata_prev_transaction_id
        description: "Previous Transaction ID | example: 70974432245344"

      - name: metadata_prev_transaction_record_id
        description: "Previous Transaction Record ID | example: 70974432245344"

      - name: metadata_commit_timestamp
        description: "Commit Timestamp | example: 2023-03-29T15:30:19.109655Z"

      - name: metadata_stream_position
        description: "Stream Position | example:"

      - name: metadata_insert_datetime
        description: "This is the current timestamp in UTC when the record is inserted"
        tests:
          - not_null

      - name: metadata_batch_user
        description: "Batch user. Default value will be dbt"
        tests:
          - not_null

      - name: landing_id
        description: ""

      - name: landing_file_name
        description: ""

      - name: landing_file_row_number
        description: ""

      - name: landing_file_last_modified
        description: ""

      - name: landing_timestamp
        description: ""

      - name: landing_cloudevent_id
        description: ""

      - name: landing_cloudevent_specversion
        description: ""

      - name: landing_cloudevent_time
        description: ""

      - name: landing_cloudevent_source
        description: ""

      - name: landing_cloudevent_subject
        description: ""

      - name: landing_cloudevent_stream
        description: ""

      - name: landing_cloudevent_type
        description: ""

      - name: landing_cloudevent_dataschema
        description: ""

      - name: landing_cloudevent_traceparent
        description: ""

      - name: landing_cloudevent_tracestate
        description: ""

      - name: landing_cloudevent_check_sum
        description: ""

      - name: landing_cloudevent_router_database
        description: ""

      - name: landing_cloudevent_router_schema
        description: ""

      - name: landing_cloudevent_router_table
        description: ""

      - name: landing_cloudevent_validated
        description: ""

      - name: landing_cloudevent_data_contract_version
        description: ""

      - name: landing_cloudevent_datacontenttype
        description: ""

      - name: landing_cloudevent_exception_error
        description: ""